# Migration `20200520172524-initial`

This migration has been generated by Manthankumar Satani at 5/20/2020, 5:25:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."bids" (
"active" boolean   DEFAULT true,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"orders_id" integer  NOT NULL ,"price" Decimal(65,30)  NOT NULL ,"status" integer   DEFAULT 0,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"users_id" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."categories" (
"active" boolean   DEFAULT true,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text   ,"id" SERIAL,"img_url" text   ,"name" text   ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"url" text   ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."categoriesaddresses" (
"active" boolean   DEFAULT true,"address" text  NOT NULL ,"categories_id" integer  NOT NULL ,"chain_id" text  NOT NULL ,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."erc20tokens" (
"active" boolean   DEFAULT true,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"decimal" integer  NOT NULL ,"icon" text   ,"id" SERIAL,"name" text   ,"symbol" text   ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."erc20tokensaddresses" (
"active" boolean   DEFAULT true,"address" text  NOT NULL ,"chain_id" text  NOT NULL ,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"token_id" integer  NOT NULL ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."favorites" (
"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"tokens_id" integer  NOT NULL ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"users_id" integer  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."orders" (
"active" boolean   DEFAULT true,"categories_id" integer  NOT NULL ,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"erc20tokens_id" integer  NOT NULL ,"expiry_date" timestamp(3)   ,"id" SERIAL,"maker_address" integer  NOT NULL ,"min_price" Decimal(65,30)  NOT NULL ,"price" Decimal(65,30)  NOT NULL ,"signature" text   ,"status" integer   DEFAULT 0,"taker_address" integer   ,"taker_amount" Decimal(65,30)   ,"tokens_id" integer  NOT NULL ,"txhash" text   ,"type" text  NOT NULL ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"views" integer   DEFAULT 0,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."tokens" (
"active" boolean   DEFAULT true,"categories_id" integer  NOT NULL ,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"description" text   ,"id" SERIAL,"img_url" text   ,"metadata" jsonb   ,"token_id" text  NOT NULL ,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"users_id" integer  NOT NULL ,
    PRIMARY KEY ("token_id","categories_id"))

CREATE TABLE "public"."users" (
"active" boolean   DEFAULT true,"address" text  NOT NULL ,"created" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" SERIAL,"updated" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "tokens.id" ON "public"."tokens"("id")

CREATE UNIQUE INDEX "users.address" ON "public"."users"("address")

ALTER TABLE "public"."bids" ADD FOREIGN KEY ("orders_id")REFERENCES "public"."orders"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."bids" ADD FOREIGN KEY ("users_id")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."categoriesaddresses" ADD FOREIGN KEY ("categories_id")REFERENCES "public"."categories"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."erc20tokensaddresses" ADD FOREIGN KEY ("token_id")REFERENCES "public"."erc20tokens"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."favorites" ADD FOREIGN KEY ("tokens_id")REFERENCES "public"."tokens"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."favorites" ADD FOREIGN KEY ("users_id")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("categories_id")REFERENCES "public"."categories"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("erc20tokens_id")REFERENCES "public"."erc20tokens"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("maker_address")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("taker_address")REFERENCES "public"."users"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("tokens_id")REFERENCES "public"."tokens"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."tokens" ADD FOREIGN KEY ("categories_id")REFERENCES "public"."categories"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."tokens" ADD FOREIGN KEY ("users_id")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200520172524-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,139 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+model bids {
+  active    Boolean? @default(true)
+  created   DateTime @default(now())
+  id        Int      @default(autoincrement()) @id
+  orders_id Int
+  price     Float
+  status    Int?     @default(0)
+  updated   DateTime @default(now())
+  users_id  Int
+  orders    orders   @relation(fields: [orders_id], references: [id])
+  users     users    @relation(fields: [users_id], references: [id])
+}
+
+model categories {
+  active              Boolean?              @default(true)
+  created             DateTime              @default(now())
+  description         String?
+  id                  Int                   @default(autoincrement()) @id
+  img_url             String?
+  name                String?
+  updated             DateTime              @default(now())
+  url                 String?
+  categoriesaddresses categoriesaddresses[]
+  orders              orders[]
+  tokens              tokens[]
+}
+
+model categoriesaddresses {
+  active        Boolean?   @default(true)
+  address       String
+  categories_id Int
+  chain_id      String
+  created       DateTime   @default(now())
+  id            Int        @default(autoincrement()) @id
+  updated       DateTime   @default(now())
+  categories    categories @relation(fields: [categories_id], references: [id])
+}
+
+model erc20tokens {
+  active               Boolean?               @default(true)
+  created              DateTime               @default(now())
+  decimal              Int
+  icon                 String?
+  id                   Int                    @default(autoincrement()) @id
+  name                 String?
+  symbol               String?
+  updated              DateTime               @default(now())
+  erc20tokensaddresses erc20tokensaddresses[]
+  orders               orders[]
+}
+
+model erc20tokensaddresses {
+  active      Boolean?    @default(true)
+  address     String
+  chain_id    String
+  created     DateTime    @default(now())
+  id          Int         @default(autoincrement()) @id
+  token_id    Int
+  updated     DateTime    @default(now())
+  erc20tokens erc20tokens @relation(fields: [token_id], references: [id])
+}
+
+model favorites {
+  created   DateTime @default(now())
+  id        Int      @default(autoincrement()) @id
+  tokens_id Int
+  updated   DateTime @default(now())
+  users_id  Int
+  tokens    tokens   @relation(fields: [tokens_id], references: [id])
+  users     users    @relation(fields: [users_id], references: [id])
+}
+
+model orders {
+  active         Boolean?    @default(true)
+  categories_id  Int
+  created        DateTime    @default(now())
+  erc20tokens_id Int
+  expiry_date    DateTime?
+  id             Int         @default(autoincrement()) @id
+  maker_address  Int
+  min_price      Float
+  price          Float
+  signature      String?
+  status         Int?        @default(0)
+  taker_address  Int?
+  taker_amount   Float?
+  tokens_id      Int
+  txhash         String?
+  type           String
+  updated        DateTime    @default(now())
+  views          Int?        @default(0)
+  categories     categories  @relation(fields: [categories_id], references: [id])
+  erc20tokens    erc20tokens @relation(fields: [erc20tokens_id], references: [id])
+  maker_users    users       @relation("maker_orders", fields: [maker_address], references: [id])
+  taker_users    users?      @relation("taker_orders", fields: [taker_address], references: [id])
+  tokens         tokens      @relation(fields: [tokens_id], references: [id])
+  bids           bids[]
+}
+
+model tokens {
+  active        Boolean?    @default(true)
+  categories_id Int
+  created       DateTime    @default(now())
+  description   String?
+  id            Int         @default(autoincrement()) @unique
+  img_url       String?
+  metadata      Json?
+  token_id      String
+  updated       DateTime    @default(now())
+  users_id      Int
+  categories    categories  @relation(fields: [categories_id], references: [id])
+  users         users       @relation(fields: [users_id], references: [id])
+  favorites     favorites[]
+  orders        orders[]
+
+  @@id([token_id, categories_id])
+}
+
+model users {
+  active       Boolean?    @default(true)
+  address      String      @unique
+  created      DateTime    @default(now())
+  id           Int         @default(autoincrement()) @id
+  updated      DateTime    @default(now())
+  bids         bids[]
+  favorites    favorites[]
+  maker_orders orders[]    @relation("maker_orders")
+  taker_orders orders[]    @relation("taker_orders")
+  tokens       tokens[]
+}
```


