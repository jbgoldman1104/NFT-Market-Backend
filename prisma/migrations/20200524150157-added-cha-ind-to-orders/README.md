# Migration `20200524150157-added-cha-ind-to-orders`

This migration has been generated by rahul at 5/24/2020, 3:01:57 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."erc20tokens" ADD COLUMN "usersId" integer   ;

ALTER TABLE "public"."erc20tokensaddresses" ADD COLUMN "usersId" integer   ;

ALTER TABLE "public"."orders" ADD COLUMN "chain_id" text  NOT NULL ;

ALTER TABLE "public"."erc20tokens" ADD FOREIGN KEY ("usersId")REFERENCES "public"."users"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."erc20tokensaddresses" ADD FOREIGN KEY ("usersId")REFERENCES "public"."users"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200523175446-address-unique..20200524150157-added-cha-ind-to-orders
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model bids {
   active    Boolean? @default(true)
@@ -54,8 +54,10 @@
   symbol               String                 @unique
   updated              DateTime               @default(now())
   erc20tokensaddresses erc20tokensaddresses[]
   orders               orders[]
+  users                users?                 @relation(fields: [usersId], references: [id])
+  usersId              Int?
 }
 model erc20tokensaddresses {
   active      Boolean?    @default(true)
@@ -65,8 +67,10 @@
   id          Int         @default(autoincrement()) @id
   token_id    Int
   updated     DateTime    @default(now())
   erc20tokens erc20tokens @relation(fields: [token_id], references: [id])
+  users       users?      @relation(fields: [usersId], references: [id])
+  usersId     Int?
 }
 model favorites {
   created   DateTime @default(now())
@@ -79,8 +83,9 @@
 }
 model orders {
   active         Boolean?    @default(true)
+  chain_id       String
   categories_id  Int
   created        DateTime    @default(now())
   erc20tokens_id Int
   expiry_date    DateTime?
@@ -125,15 +130,17 @@
   @@id([token_id, categories_id])
 }
 model users {
-  active       Boolean?    @default(true)
-  address      String      @unique
-  created      DateTime    @default(now())
-  id           Int         @default(autoincrement()) @id
-  updated      DateTime    @default(now())
+  active       Boolean?               @default(true)
+  address      String                 @unique
+  created      DateTime               @default(now())
+  id           Int                    @default(autoincrement()) @id
+  updated      DateTime               @default(now())
   bids         bids[]
   favorites    favorites[]
-  maker_orders orders[]    @relation("maker_orders")
-  taker_orders orders[]    @relation("taker_orders")
+  maker_orders orders[]               @relation("maker_orders")
+  taker_orders orders[]               @relation("taker_orders")
   tokens       tokens[]
+  approved     erc20tokensaddresses[]
+  erc20tokens  erc20tokens[]
 }
```


