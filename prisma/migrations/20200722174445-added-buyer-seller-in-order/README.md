# Migration `20200722174445-added-buyer-seller-in-order`

This migration has been generated by rahuldamodar94 at 7/22/2020, 5:44:46 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."orders" DROP CONSTRAINT IF EXiSTS "orders_maker_address_fkey",
DROP CONSTRAINT IF EXiSTS "orders_taker_address_fkey",
ADD COLUMN "buyer" integer   ,
ADD COLUMN "seller" integer   ;

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("buyer")REFERENCES "public"."users"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."orders" ADD FOREIGN KEY ("seller")REFERENCES "public"."users"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200721174744-auction-logic-upgrade..20200722174445-added-buyer-seller-in-order
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model bids {
   active    Boolean? @default(true)
@@ -96,14 +96,16 @@
   maker_amount   Float?
   tokens_id      String
   txhash         String?
   type           String
+  buyer          Int?
+  seller         Int?
   updated        DateTime        @default(now())
   views          Int?            @default(0)
   categories     categories      @relation(fields: [categories_id], references: [id])
   erc20tokens    erc20tokens     @relation(fields: [erc20tokens_id], references: [id])
-  maker_users    users?          @relation("maker_orders", fields: [maker_address], references: [id])
-  taker_users    users?          @relation("taker_orders", fields: [taker_address], references: [id])
+  buyer_users    users?          @relation("buyer_orders", fields: [buyer], references: [id])
+  seller_users   users?          @relation("seller_orders", fields: [seller], references: [id])
   bids           bids[]
   notifications  notifications[]
   favourites     favourites[]
 }
@@ -115,10 +117,10 @@
   id            Int             @default(autoincrement()) @id
   updated       DateTime        @default(now())
   bids          bids[]
   favourites    favourites[]
-  maker_orders  orders[]        @relation("maker_orders")
-  taker_orders  orders[]        @relation("taker_orders")
+  buyer_orders  orders[]        @relation("buyer_orders")
+  seller_orders orders[]        @relation("seller_orders")
   notifications notifications[]
 }
 model admins {
```


