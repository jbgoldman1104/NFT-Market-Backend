# Migration `20200715111112-notification-schema-update`

This migration has been generated by rahuldamodar94 at 7/15/2020, 11:11:12 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."notifications" DROP CONSTRAINT IF EXiSTS "notifications_buyer_id_fkey",
DROP CONSTRAINT IF EXiSTS "notifications_seller_id_fkey",
DROP CONSTRAINT IF EXiSTS "notifications_usersId_fkey",
DROP COLUMN "buyer_id",
DROP COLUMN "seller_id",
DROP COLUMN "usersId",
ADD COLUMN "usersId" integer  NOT NULL ;

ALTER TABLE "public"."notifications" ADD FOREIGN KEY ("usersId")REFERENCES "public"."users"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200715104314-chg-notification-rename-admin..20200715111112-notification-schema-update
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model bids {
   active        Boolean?        @default(true)
@@ -111,22 +111,20 @@
   favourites     favourites[]
 }
 model users {
-  active              Boolean?               @default(true)
-  address             String                 @unique
-  created             DateTime               @default(now())
-  id                  Int                    @default(autoincrement()) @id
-  updated             DateTime               @default(now())
-  bids                bids[]
-  favourites          favourites[]
-  maker_orders        orders[]               @relation("maker_orders")
-  taker_orders        orders[]               @relation("taker_orders")
-  maker_notifications notifications[]        @relation("buyer_notifications")
-  taker_notifications notifications[]        @relation("seller_notifications")
-  approved            erc20tokensaddresses[]
-  erc20tokens         erc20tokens[]
-  notifications       notifications[]
+  active        Boolean?               @default(true)
+  address       String                 @unique
+  created       DateTime               @default(now())
+  id            Int                    @default(autoincrement()) @id
+  updated       DateTime               @default(now())
+  bids          bids[]
+  favourites    favourites[]
+  maker_orders  orders[]               @relation("maker_orders")
+  taker_orders  orders[]               @relation("taker_orders")
+  approved      erc20tokensaddresses[]
+  erc20tokens   erc20tokens[]
+  notifications notifications[]
 }
 model admins {
   active   Boolean? @default(true)
@@ -137,21 +135,17 @@
   updated  DateTime @default(now())
 }
 model notifications {
-  read      Boolean  @default(true)
-  active    Boolean  @default(true)
-  created   DateTime @default(now())
-  id        Int      @default(autoincrement()) @id
-  message   String
-  buyer_id  Int
-  buyers    users    @relation("buyer_notifications", fields: [buyer_id], references: [id])
-  seller_id Int
-  sellers   users    @relation("seller_notifications", fields: [seller_id], references: [id])
-  updated   DateTime @default(now())
-  order_id  Int
-  orders    orders   @relation(fields: [order_id], references: [id])
-  bid_id    Int?
-  bids      bids?    @relation(fields: [bid_id], references: [id])
-  users     users?   @relation(fields: [usersId], references: [id])
-  usersId   Int?
+  read     Boolean  @default(true)
+  active   Boolean  @default(true)
+  created  DateTime @default(now())
+  id       Int      @default(autoincrement()) @id
+  message  String
+  updated  DateTime @default(now())
+  order_id Int
+  orders   orders   @relation(fields: [order_id], references: [id])
+  bid_id   Int?
+  bids     bids?    @relation(fields: [bid_id], references: [id])
+  users    users    @relation(fields: [usersId], references: [id])
+  usersId  Int
 }
```


